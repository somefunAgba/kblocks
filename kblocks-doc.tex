\documentclass[onecolumn,a4paper,10pt]{IEEEtran}
%\documentclass{article}

\usepackage{kblocks}
%\tikzexternalize[prefix=figs/] % activate tikzpicture exports

\usepackage{bm}
\usepackage{listings}

\usepackage{verbatim}
\usepackage{fancyvrb} % extended verbatim environments
\usepackage{fancyvrb-ex}


\usepackage{units}

\usepackage{zi4}
%\usepackage{garamondx}
%\usepackage[lig=true]{baskervald}
%\usepackage{palatino}
%\def\rmdefault{zi4}
%\def\sfdefault{zi4}
\usepackage[defaultsans]{lato}

\usepackage{csquotes}
\usepackage{garamondx}

\newcommand*{\kblocks}{\relax~\textit{k}\textsc{blocks}}
\newcommand*{\Tikz}{
    Ti\textit{k}Z
}
\newcommand*{\TikzPGF}{\relax~{Ti\textit{k}Z/\textsc{pgf}}}
\newcommand*{\spacetweak}{\medskip\medskip}

\DefineVerbatimEnvironment
{cvl}{Verbatim}
{formatcom=\color{blue!10!black!90},
	numbers=left,numbersep=2mm,gobble=0,
	frame=lines,rulecolor=\color{gray},framesep=1mm,
	fontseries=,labelposition=none,fontsize=\normalsize, 
	xrightmargin=1cm, samepage=true}
%
\newenvironment{apilist}{
	\vspace{1ex}}%
{\vspace{1em}}
%
\newcommand{\cvhd}[1]{{
		{\subsection{#1}}{\mbox{}\break}\vspace{-5ex}
}}

%
\fvset{formatcom=\color{lightgray},
	fontfamily=tt,fontsize=\footnotesize, fontseries=b,
	frame=single,rulecolor=\color{olive},label=\fbox{A},
	numbers=left,numbersep=5pt}
%red,green,blue,cyan,magenta,yellow,black,gray,white,
%darkgray,lightgray,brown,lime,olive,orange,pink,purple,teal,violet


\begin{document}

\title{\kblocks~Package}
\author{

\IEEEauthorblockN{
\textsc{Oluwasegun~Somefun}~(\textbf{oasomefun@futa.edu.ng}) \\
\footnotesize{\textsc{Department of Computer Engineering, Federal University of Technology, Akure, Nigeria}}
}

}

\markboth{\kblocks~Demo. Version~1.0. 13, October~2019};

\maketitle

\section{Introduction}
Welcome to the demo documentation of\kblocks. Desiring to typeset control block diagrams in \LaTeX~and dissatisfied with the other \LaTeX~macro packages that
can be found online, I thought: \textit{why not write my own macro package for this purpose}.

I wish to start with the question, \enquote{What is\kblocks?} The\kblocks~macro package is the product of using\TikzPGF~to
directly typeset beautiful control block diagrams and signal flow graphs in my Masters' dissertation and papers directly with \LaTeX.
Basically, it just defines a dedicated \enquote{kblock} environment and a number of macro commands to make drawing control block diagrams using\TikzPGF~ more structured and easier. In a sense, when you
use\kblocks~you \textit{program} or typeset graphics for control block diagrams, just as you “program” graphics in your document when you use
\LaTeX~using\TikzPGF.

The powerful options offered by\TikzPGF~often intimidates beginner users not ready to spend careful time learning about\TikzPGF. Like all
\LaTeX~packages,\TikzPGF~inherits the steep learning curve of \LaTeX, that is, no \textit{what you see is what you get}.
The\kblocks~macro reduces the length of this learning curve, by focusing the graphics theme on control block diagrams only.
Fortunately this documentation as it grows and gets to be improved, will come with a number of slowly-paced
tutorials, which will guide you on creating control block diagrams with\kblocks~without your having to read the\TikzPGF~manual.

My wish is that you do find it useful and helpful. Please, don't forget to share and like if you did.

I will readily welcome any e-mails for improvement or suggestion with respect to
using\kblocks~and making it useful for researchers, students and others involved in the applications and field of control theory.

\centering

\section{Demos}
\spacetweak\spacetweak
\begin{SideBySideExample}[label=\fbox{A},xrightmargin=10cm]
\begin{kblock}
	% global ref point
	\kJumpCS{init}
	%% blocks
	\kMarkNodeRight{0.2cm}{0cm}{$r$}{init}{rin}
	\kPlusPlusMinus{rin}{sb1}{0.2cm}
	\kTFRight[0.2cm]{sb1}{tfb1}{$\frac{1}{s}$}
	\kMarkNodeRight{0.2cm}{0cm}{}{tfb1}{ny}
	\kOutRight[0.2cm]{ny}{yout}{$y$}{0cm}
	%% links
	\kLink[]{rin}{sb1}
	\kLink[$e$]{sb1}{tfb1}
	\kLinkn[]{tfb1}{ny}
	\kLinkVHHVBelow[0cm]{$1$}{ny}{sb1}{0}{0}
	\kLinkVHHVAbove[0cm]{$1$}{ny}{sb1}{0}{0}
\end{kblock}
\end{SideBySideExample}

\spacetweak\spacetweak
\begin{SideBySideExample}[label=\fbox{B},xrightmargin=10cm]
\begin{kblock}
% global ref point
\kJumpCS{init}
%% blocks
\kMarkNodeRight{0.2cm}{0cm}{$r$}{init}{rin}
\kPlusMinusDown{rin}{sb1}{0.2cm}
\kTFRight[0.25cm]{sb1}{tfb1}{$G\left( s \right)$}
\kTFBelow[0.2cm]{tfb1}{tfb2}{$H\left( s \right)$}
\kMarkNodeRight{0.2cm}{0cm}{}{tfb1}{ny}
\kOutRight[0.2cm]{ny}{yout}{$y$}{0cm}
%% links
\kLinkVH[$y$]{ny}{tfb2}{0}{0}{0}
\kLinkHV[$\hat{y}$]{tfb2}{sb1}{0}{0}{2}
\kLink[]{rin}{sb1}
\kLink[$e$]{sb1}{tfb1}
\kLinkn[]{tfb1}{ny}
%% coverings
\kCoverRect[blue]{sb1}{1cm}{2cm}{0.5cm}{3cm}
\kCoverTextLeft{2cm}{1cm}{covtx}{Closed-loop system};
\end{kblock}
\end{SideBySideExample}
	
\spacetweak\spacetweak
\begin{SideBySideExample}[label=\fbox{C},xrightmargin=10cm]
\begin{kblock}
% ref
\kJumpCS{spt}
% top blocks
\kMarkNodeRight{0cm}{0cm}{$I^\star$}{spt}{inI}
\kPlusMinusDown{inI}{sb1}{1.cm}
\kTFRight[0.2cm]{sb1}{tfb1}{$s$}
\kTFBelow[0.5cm]{sb1}{tfb2}{$\frac{1}{2}$}	
\kPlusPlusUpL{tfb2}{sb2}{0cm}
\kMinusPlusUp{tfb1}{sb3}{0cm}
\kTFRight[0cm]{sb3}{tfb3}{$0.2$}
\kTFRight[0cm]{tfb3}{tfb4}{$K_3$}
\kMarkNodeAbove{0cm}{0cm}{$V_{dc}$}{inI}{inVdc}
\kMarkNodeBelow{0cm}{0.3cm}{$V_2$}{inI}{inV2}
\kMarkNodeBelow{0cm}{-0.4cm}{$V_3$}{inV2}{inV3}
% bottom blocks
\kMarkNodeBelow{3cm}{0cm}{$V_1$}{inI}{inV1}
\kPlusPlusUpB{tfb4}{sb4}{3cm}
\kPlusMinusDown{inV1}{sb5}{0.8cm}
\kTFRight[0cm]{sb5}{tfb5}{$0.35$}
\kOutRight[0]{sb4}{outV}{$V_{out}^{\star}$}{0}
\kMarkNodeBelow{0cm}{0cm}{$V_4$}{inV1}{inV4}
% top links
\kLinkHV[]{inVdc}{sb3}{0}{0}{0}
\kLinkHV[]{inV2}{sb2}{0}{0}{0}
\kLinkHV[]{inV3}{sb2}{0}{0}{0}
\kLink[]{inI}{sb1}
\kLink[]{sb1}{tfb1}
\kLink[$I_{calc}$]{tfb2}{sb1}
\kLink[]{tfb1}{sb3}
\kLink[]{sb2}{tfb2}
\kLink[]{sb3}{tfb3}
\kLink[]{tfb3}{tfb4}
\kLink[$V_{est}$]{tfb4}{sb4}
% bottom links
\kLink[]{inV1}{sb5}
\kLink[]{sb5}{tfb5}
\kLink[]{tfb5}{sb4}
\kLinkHV[]{inV4}{sb5}{0}{0}{0}
\end{kblock}
\end{SideBySideExample}

\spacetweak\spacetweak
\section{\kblocks{} API}

\begin{apilist}
\cvhd{Place an invisible Node at origin, as reference point}
\begin{cvl}
\kJumpCS{current coordinate label}
\end{cvl}

\cvhd{Place Node with variable x-y coordinate shift}
\begin{cvl}
\kMarkNodeLeft{optional x distance shift}{optional y distance shift}
{node text-label}{from node label}{to current node label}

\kMarkNodeRight{optional x distance shift}{optional y distance shift}
{node text-label}{from node label}{to current node label}

\kMarkNodeAbove{optional x distance shift}{optional y distance shift}
{node text-label}{from node label}{to current node label}

\kMarkNodeBelow{optional x distance shift}{optional y distance shift}
{node text-label}{from node label}{to current node label}
\end{cvl}
	
\cvhd{Place a Node at a specific coordinate}
\begin{cvl}
\kMarkNode{optional x distance shift}{optional y distance shift}
{node label}{current node coordinate}
\end{cvl}

\cvhd{Arithmetic Summer Blocks}
\begin{cvl}
\kPlusPlusMinus{from node label}{to current sum node label}
{optional horizontal position shift}
\end{cvl}

\cvhd{Transfer-Function block}
\begin{cvl}
\kTFRight[optional shift dimension]{from node label}
{to current tf node label}{tf text content}
\end{cvl}

\cvhd{Scalar Link (arrowed) and Linkn (no arrow)}
\begin{cvl}
\kLink[optional signal label]{from node label}{to node label}

\kLinkn[optional signal label]{from node label}{to node label}
\end{cvl}


\cvhd{Output Link from a node point}
\begin{cvl}
\kOutRight[optional distance shift]{from node label}
{to current node label}{out signal label}{direction shift}
\end{cvl}


\cvhd{Scalar Link Full Feedback/FeedForward Vertical (Up or Down) to Horizontal (Right or Left) to Vertical (Up or Down)}
\begin{cvl}
\kLinkVHHVBelow{optional link shift}{unity link label}
{from node}{to node}{from node direction shift}{to node direction shift}

\kLinkVHHVAbove{optional link shift}{unity link label}
{from node}{to node}{from node direction shift}{to node direction shift}
\end{cvl}





\end{apilist}
\spacetweak

%\subsection{}\spacetweak
%
%\begin{kblock}
%  \kStartNodec[]{(5,-5)}{R1}
%  \kTFRight{R1}{M1}{$\bm{\hat{m}$}\\\textbf{PID}\\\textbf{model}}
%  \kOutDown[]{M1}{um}{$u_m$}{0}
%  \kScaleDistX[1.5]
%  \kTFRight{M1}{C1}{$\bm{K\left(y_m,y\right)}$\\\textbf{PID}\\\textbf{controller}}
%  \kTFBelowRight{0cm}{0.2cm}{C1}{P1}{$\bm{P\left(s\right)}$\\\textbf{process}}
%
%  \kLink[$r$]{R1}{M1}
%  \kLink[$y_m$]{M1}{C1}
%  \kLinkHV[$u$]{C1}{P1}{0}{}
%  \kLinkHV[$y$]{P1}{C1}{0}{}
%\end{kblock}
%
%\begin{lstlisting}
%\begin{kblock}
%  \kStartNodec[]{(5,-5)}{R1}
%  \kTFRight{R1}{M1}{$\bm{\hat{m}$}\\\textbf{PID}\\\textbf{model}}
%  \kOutDown[]{M1}{um}{$u_m$}{0}
%  \kScaleDistX[1.5]
%  \kTFRight{M1}{C1}{$\bm{K\left(y_m,y\right)}$\\\textbf{PID}\\\textbf{controller}}
%  \kTFBelowRight{0cm}{0.2cm}{C1}{P1}{$\bm{P\left(s\right)}$\\\textbf{process}}
%
%  \kLink[$r$]{R1}{M1}
%  \kLink[$y_m$]{M1}{C1}
%  \kLinkHV[$u$]{C1}{P1}{0}{}
%  \kLinkHV[$y$]{P1}{C1}{0}{}
%\end{kblock}
%\end{lstlisting}
%\spacetweak
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%
%  \kJumpCS[$(0,0)$]{R}
%
%  \kTFRight{R}{M1}{$\bm{\hat{m}$}\\\textbf{closed}\\\textbf{PID-loop}\\\textbf{ model}}
%  \kInLeft[0cm]{M1}{RI}{$r$}{0.1}
%  \kOutDown[]{M1}{um}{$u_m$}{0}
%  \kScaleDistX[1.75]
%  \kTFRight{M1}{C1}{$\bm{K\left(y_m,y\right)}$\\\textbf{PID}\\\textbf{controller}}
%  \kScaleDistX[1]
%  \kTFBelow{C1}{P1}{$\bm{P\left(s\right)}$\\\textbf{process}}
%
%%  \kLink[$r$]{R1}{M1}
%  \kLink[$y_m$]{M1}{C1}
%  \kLinkHVHRight[0]{$u$}{C1}{P1}{0}{0}
%  \kLinkHVHLeft[0.33]{$y$}{P1}{C1}{0}{-0.25}
%\end{kblock}
%\begin{lstlisting}
%\begin{kblock}
%  \kStartNodec[]{(-5,-5)}{R1}
%  \kTFRight{R}{M1}{$\bm{\hat{m}$}\\\textbf{closed}\\\textbf{PID-loop}\\\textbf{ model}}
%  \kOutDown[]{M1}{um}{$u_m$}{0}
%  \kScaleDistX[1.75]
%  \kTFRight{M1}{C1}{$\bm{K\left(y_m,y\right)}$\\\textbf{PID}\\\textbf{controller}}
%  \kScaleDistX[1]
%  \kTFBelow{C1}{P1}{$\bm{P\left(s\right)}$\\\textbf{process}}
%
%  \kLink[$r$]{R1}{M1}
%  \kLink[$y_m$]{M1}{C1}
%  \kLinkHVHRight[0]{$u$}{C1}{P1}{0}{0}
%  \kLinkHVHLeft[0.33]{$y$}{P1}{C1}{0}{-0.25}
%\end{kblock}
%\end{lstlisting}
%\spacetweak
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%    \kJumpCS[$(0,0)$]{R}
%
%    \kJumpCSRight[-0.5cm]{R}{CR}{0}{3}
%    \kJumpCSLeft[-0.5cm]{R}{CR}{0}{9}
%    \kJumpCSAbove[-0.5cm]{R}{CR}{0}{12}
%    \kJumpCSBelow[-0.5cm]{R}{CR}{0}{6}
%
%    \kTFBelow{R}{C1}{\bfseries{PID}$\bm{(\cdot)}$}
%    \kScaleDistX[0.67]
%    \kTFBelow{C1}{P1}{$\bm{P(s)}$}
%    \kScaleDistX[1]
%
%    \kInLeft[0cm]{C1}{RI}{$r$}{0.1}
%
%    \kMarkNodeLeft[0cm]{}{P1}{ON}
%    \kLinkn[]{P1}{ON}
%    \kOutLeft[-0.5cm]{ON}{Y}{$y$}{0}
%    \kLinkVH[$y$]{ON}{C1}{-0.1}{}
%
%    \kLinkHVHRight[0]{$u$}{C1}{P1}{0}{0}
%
%    \kCoverRect[magenta!5!red]{P1}{0.1cm}{0.1cm}{0.2cm}{0.2cm}
%    \kCoverTextBelow{0}{0}{TXT1}{physical system (e.g: a dc motor)};
%    \kCoverRect[green!75!blue!80!]{C1}{0.1cm}{0.1cm}{0.2cm}{0.2cm}
%    \kCoverTextAbove{0}{0}{TXT2}{computing system (embedded control algorithm)};
%\end{kblock}
%
%\begin{lstlisting}
%\begin{kblock}
%  \kJumpCS[$(0,0)$]{R}
%
%    \kJumpCSRight[-0.5cm]{R}{CR}{0}{3}
%    \kJumpCSLeft[-0.5cm]{R}{CR}{0}{9}
%    \kJumpCSAbove[-0.5cm]{R}{CR}{0}{12}
%    \kJumpCSBelow[-0.5cm]{R}{CR}{0}{6}
%
%    \kTFBelow{R}{C1}{\bfseries{PID}$\bm{(\cdot)}$}
%    \kScaleDistX[0.67]
%    \kTFBelow{C1}{P1}{$\bm{P(s)}$}
%    \kScaleDistX[1]
%
%    \kInLeft[0cm]{C1}{RI}{$r$}{0.1}
%
%    \kMarkNodeLeft[0cm]{}{P1}{ON}
%    \kLinkn[]{P1}{ON}
%    \kOutLeft[-0.5cm]{ON}{Y}{$y$}{0}
%    \kLinkVH[$y$]{ON}{C1}{-0.1}{}
%
%    \kLinkHVHRight[0]{$u$}{C1}{P1}{0}{0}
%
%
%\end{kblock}
%\end{lstlisting}
%\spacetweak
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%  \kJumpCS[$(5,5)$]{R1}
%
%  \kTFRight{R1}{P1}{$\bm{P}$}
%  \kScaleDistX[0.67]
%  \kTFBelow{P1}{C1}{$\bm{C}$}
%  \kScaleDistX[1]
%
%  \kInLeft[]{P1}{RI}{$w$}{0.1}
%  \kInLeft[]{C1}{RC}{$r$}{-0.1}
%
%  \kLinkHVHRight[0.2]{$y$}{P1}{C1}{-0.1}{0.1}
%  \kLinkHVHLeft[0.2]{$u$}{C1}{P1}{0.1}{-0.1}
%
%  \kOutRight[0cm]{P1}{Z}{$z$}{0.1}
%  \kOutRight[]{C1}{V}{$v$}{-0.1}
%
%  \kCoverRect[blue!50!]{P1}{0.1cm}{0.1cm}{0.2cm}{0.2cm}
%  \kCoverTextAbove{0}{0}{TX1}{Physical System};
%
%  \kCoverRect[red]{C1}{0.1cm}{0.1cm}{0.2cm}{0.2cm}
%  \kCoverTextBelow{0cm}{0cm}{TX2}{Computing System};
%\end{kblock}
%
%\begin{lstlisting}
%\begin{kblock}
%  \kJumpCS[$(5,5)$]{R1}
%
%  \kTFRight{R1}{P1}{$\bm{P}$}
%  \kScaleDistX[0.67]
%  \kTFBelow{P1}{C1}{$\bm{C}$}
%  \kScaleDistX[1]
%
%  \kInLeft[]{P1}{RI}{$w$}{0.1}
%  \kInLeft[]{C1}{RC}{$r$}{-0.1}
%
%  \kLinkHVHRight[0.2]{$y$}{P1}{C1}{-0.1}{0.1}
%  \kLinkHVHLeft[0.2]{$u$}{C1}{P1}{0.1}{-0.1}
%
%  \kOutRight[0cm]{P1}{Z}{$z$}{0.1}
%  \kOutRight[]{C1}{V}{$v$}{-0.1}
%
%  \kCoverRect[blue!50!]{P1}{0.1cm}{0.1cm}{0.2cm}{0.2cm}
%  \kCoverTextAbove{0}{0}{TX1}{Physical System};
%
%  \kCoverRect[red]{C1}{0.1cm}{0.1cm}{0.2cm}{0.2cm}
%  \kCoverTextBelow{0cm}{0cm}{TX2}{Computing System};
%\end{kblock}
%\end{lstlisting}
%
%\spacetweak
%
%\subsection{}\spacetweak
%\begin{kblock}
%\kJumpCS[$(0,0)$]{io}
%\kJumpCSLeft[-0.5cm]{io}{jl}{0}{9}
%\kCoverRect[blue]{jl}{2cm}{2cm}{2cm}{2cm}
%\end{kblock}
%
%\begin{lstlisting}
%\begin{kblock}
%\kJumpCS[$(0,0)$]{io}
%\kJumpCSLeft[-0.5cm]{io}{jl}{0}{9}
%\kCoverRect[blue]{jl}{2cm}{2cm}{2cm}{2cm}
%\end{kblock}
%\end{lstlisting}
%
%\spacetweak
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%  \kJumpCS[$(0,0)$]{spt}
%
%  \kPlusMinusDown{spt}{sum1}{}
%  \kInLeft[0.5cm]{sum1}{rin}{$r$}{0cm}
%  \kMarkNodeRight[0cm]{}{rin}{rtop}
%
%  \kTFRight[0.1cm]{sum1}{tfA}{$\bm{A}$}
%  \kLink[$e$]{sum1}{tfA}
%  \kTFAbove[]{tfA}{tfB}{$\bm{B}$}
%  \kLinkVH[]{rtop}{tfB}{0cm}{}
%  \kPlusPlusMinus{tfA}{sum2}{0cm}
%  \kLink[]{tfA}{sum2}
%  \kTFRight[0cm]{sum2}{tfP}{$\bm{P(s)}$}
%  \kLinkHV[]{tfB}{sum2}{0cm}{}
%  \kLink[$u$]{sum2}{tfP}
%  \kTFBelow[]{tfP}{tfD}{$\bm{D}$}
%  \kLinkHV[]{tfD}{sum2}{0cm}{}
%  \kOutRight[0.5cm]{tfP}{yout}{$y$}{0cm}
%
%  \kMarkNodeLeft[0cm]{}{yout}{ycut}
%
%  \kLinkVH[]{ycut}{tfD}{0cm}{mkpt2y}
%
%  \kLinkVHHVBelow[0cm]{}{mkpt2y}{sum1}{0}{0}
%
%\end{kblock}
%
%\begin{lstlisting}
%\begin{kblock}
%  \kJumpCS[$(0,0)$]{spt}
%
%  \kPlusMinusDown{spt}{sum1}{}
%  \kInLeft[0.5cm]{sum1}{rin}{$r$}{0cm}
%  \kMarkNodeRight[0cm]{}{rin}{rtop}
%
%  \kTFRight[0.1cm]{sum1}{tfA}{$\bm{A}$}
%  \kLink[$e$]{sum1}{tfA}
%  \kTFAbove[]{tfA}{tfB}{$\bm{B}$}
%  \kLinkVH[]{rtop}{tfB}{0cm}{}
%  \kPlusPlusMinus{tfA}{sum2}{0cm}
%  \kLink[]{tfA}{sum2}
%  \kTFRight[0cm]{sum2}{tfP}{$\bm{P(s)}$}
%  \kLinkHV[]{tfB}{sum2}{0cm}{}
%  \kLink[$u$]{sum2}{tfP}
%  \kTFBelow[]{tfP}{tfD}{$\bm{D}$}
%  \kLinkHV[]{tfD}{sum2}{0cm}{}
%  \kOutRight[0.5cm]{tfP}{yout}{$y$}{0cm}
%
%  \kMarkNodeLeft[0cm]{}{yout}{ycut}
%
%  \kLinkVH[]{ycut}{tfD}{0cm}{mkpt2y}
%
%  \kLinkVHHVBelow[0cm]{}{mkpt2y}{sum1}{0}{0}
%\end{kblock}
%\end{lstlisting}
%
%\spacetweak
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%  \kJumpCS[$(0,0)$]{spt}
%
%  \kPlusMinusDown{spt}{sum1}{}
%  \kInLeft[0.5cm]{sum1}{rin}{$r$}{0cm}
%  \kMarkNodeRight[0cm]{}{rin}{rtop}
%
%  \kTFRight[0.1cm]{sum1}{tfA}{$\bm{A}$}
%  \kLink[$e$]{sum1}{tfA}
%  \kTFAbove[]{tfA}{tfB}{$\bm{B}$}
%  \kLinkVH[]{rtop}{tfB}{0cm}{}
%  \kPlusPlusMinus{tfA}{sum2}{0cm}
%  \kLink[]{tfA}{sum2}
%  \kTFRight[0cm]{sum2}{tfPD}{$\bm{C}$}
%  \kLinkHV[]{tfB}{sum2}{0cm}{}
%  \kLink[$u$]{sum2}{tfPD}
%
%  \kOutRight[0.5cm]{tfPD}{yout}{$y$}{0cm}
%
%  \kMarkNodeLeft[0cm]{}{yout}{ycut}
%
%  \kLinkVHHVBelow[0.2cm]{}{ycut}{sum1}{0}{0}
%\end{kblock}
%
%\begin{lstlisting}
%\begin{kblock}
%  \kJumpCS[$(0,0)$]{spt}
%
%  \kPlusMinusDown{spt}{sum1}{}
%  \kInLeft[0.5cm]{sum1}{rin}{$r$}{0cm}
%  \kMarkNodeRight[0cm]{}{rin}{rtop}
%
%  \kTFRight[0.1cm]{sum1}{tfA}{$\bm{A}$}
%  \kLink[$e$]{sum1}{tfA}
%  \kTFAbove[]{tfA}{tfB}{$\bm{B}$}
%  \kLinkVH[]{rtop}{tfB}{0cm}{}
%  \kPlusPlusMinus{tfA}{sum2}{0cm}
%  \kLink[]{tfA}{sum2}
%  \kTFRight[0cm]{sum2}{tfPD}{$\bm{C}$}
%  \kLinkHV[]{tfB}{sum2}{0cm}{}
%  \kLink[$u$]{sum2}{tfPD}
%
%  \kOutRight[0.5cm]{tfPD}{yout}{$y$}{0cm}
%
%  \kMarkNodeLeft[0cm]{}{yout}{ycut}
%
%  \kLinkVHHVBelow[0.2cm]{}{ycut}{sum1}{0}{0}
%\end{kblock}
%\end{lstlisting}
%
%
%\spacetweak
%
%\subsection{}\spacetweak
%\begin{kblock}
%\kJumpCS{bpt}
%\kTFBelow[0cm]{bpt}{fp}{$\bm{f_p(\cdot)}$}
%\kTFBelow[0cm]{fp}{fd}{$\bm{f_d(\cdot)}$}
%\kTFBelow[0cm]{fd}{fi}{$\bm{f_i(\cdot)}$}
%
%\kInLeft[0cm]{fp}{ymin}{$\bm{y_m}$}{-0.15}
%\kInLeft[0cm]{fp}{yin}{$\bm{y}$}{0.15}
%\kInUp[0cm]{fp}{uin}{$\bm{u}$}{0}
%
%\kOutRight[0cm]{fp}{kp}{$\bm{K_p}$}{0}
%\kOutRight[0cm]{fi}{ki}{$\bm{K_i}$}{0}
%\kOutRight[0cm]{fd}{kd}{$\bm{K_d}$}{0}
%
%\kMarkNodeRight[-0.3cm]{}{fp}{mkkp1}
%
%\kLinkVH[]{mkkp1}{fd}{0.2}{mkkp2}
%\kLinkVH[]{mkkp2}{fi}{0.2}{}
%
%\kInLeft[0cm]{fd}{wnin}{$\bm{\omega_n}$}{0}
%\kMarkNodeRight[-0.5cm]{}{wnin}{mkwn}
%\kLinkVH[]{mkwn}{fi}{0}{}
%\end{kblock}
%
%
%\spacetweak
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%\kJumpCS{fspt}
%\kTFBelow[0cm]{fspt}{fis}{\textbf{FIS}}
%\kTFBelow[0.3cm]{fis}{tscalc}{$\bm{f_{\omega_n}(\cdot)}$}
%\kTFBelow[0.5cm]{tscalc}{pidcm}{
%\textbf{PID closed-loop model}\\
%$
%\begin{array}{c}
%	\bm{\dot{x}_m=A_m{x_m}+B_m{r}}\\
%%	y_m=\bm{C_m{x_m}}\\
%\end{array}
%$
%}
%
%\kLink[$\bm{\omega_n}$]{tscalc}{pidcm}
%\kLink[$\bm{x_{s},x_{pk}}$]{fis}{tscalc}
%\kInLeft[0cm]{pidcm}{rin}{$\bm{r}$}{0}
%\kOutDown[0cm]{pidcm}{umout}{$\bm{u_m}$}{0}
%\kInLeft[0cm]{tscalc}{timein}{$\bm{t_s, L}$}{0}
%\kInUp[0cm]{fis}{bin}{$\bm{b}$}{-0.15}
%\kInUp[0cm]{fis}{cin}{$\bm{c}$}{0.15}
%
%\kTFRight[2.2cm]{pidcm}{pid}{
%\textbf{PID}\\
%$\bm{u = f_{pid}(\cdot)}$
%}
%\kInDown[-0.4cm]{pid}{cp}{$\bm{\lambda_p}$}{-0.33}
%\kInDown[-0.4cm]{pid}{ci}{$\bm{\lambda_i}$}{0.33}
%\kInDown[-0.2cm]{pid}{cd}{$\bm{\lambda_d}$}{0}
%
%\kTFRight[1cm]{pid}{plt}{$\bm{P(s)}$}
%\kTFBelowRight{0.5cm}{-0.2cm}{plt}{obsdiff}{
%\textbf{State Observer}\\
%$
%\begin{array}{c}
%	\bm{\hat{\dot{x}}=A_o{\hat{x}}+B_o{y}}\\
%\end{array}
%$
%}
%
%\kLink[$\bm{{x}_m}$]{pidcm}{pid}
%\kLink[$\bm{u}$]{pid}{plt}
%\kLinkHVHRight[2]{$\bm{y}$}{plt}{obsdiff}{0}{0}
%\kLinkHVHLeft[2.7]{$\bm{\hat{x}}$}{obsdiff}{pid}{-0.1}{-0.2}
%
%\kMarkNodeRight[0cm]{}{pid}{mku}
%\kLinkVH[]{mku}{obsdiff}{0.1}{}
%\kLinkVHHVAbove[]{}{mku}{pid}{0}{0.5}
%
%\kMarkNodeAbove[-0.15cm]{}{pidcm}{mkwn}
%\kLinkHV[]{mkwn}{pid}{-0.3}{}
%\kMarkNodeBelow[-0.5cm]{}{bin}{mkb}
%\kLinkHV[]{mkb}{pid}{-0.1}{}
%\kMarkNodeBelow[-0.7cm]{}{cin}{mkc}
%\kLinkHV[]{mkc}{pid}{0.1}{}
%
%\end{kblock}
%
%
%\subsection{}\spacetweak
%
%\begin{kblock}
%\kJumpCS{fspt}
%
%\kTFBelow[0.5cm]{fspt}{plt}{\textbf{Plant }$\bm{P(s)}$}
%
%\kTFBelow[0cm]{plt}{pidcm}{
%\textbf{PID closed-loop model}\\
%$
%\begin{array}{c}
%	\bm{\dot{x}_m=A_m{x_m}+B_m{r}}\\
%%	y_m=\bm{C_m{x_m}}\\
%\end{array}
%$
%}
%\kTFBelow[0.33cm]{pidcm}{tscalc}{$\bm{f_{\omega_n}(\cdot)}$}
%\kTFBelow[0.33cm]{tscalc}{fis}{\textbf{TSK--FIS}}
%
%
%\kTFBelow[0.2cm]{fis}{pid}{
%\textbf{PID Control Law}\\
%$\bm{u = f_{pid}(\cdot)}$
%}
%
%
%\kTFRight[3cm]{tscalc}{obs}{
%\textbf{State Observer}\\
%$
%\begin{array}{c}
%	\bm{\hat{\dot{x}}=A_o{\hat{x}}+B_o{y}}\\
%\end{array}
%$
%}
%
%
%\kInDown[-0.4cm]{pid}{cp}{$\bm{\lambda_p}$}{-0.6}
%\kInDown[-0.4cm]{pid}{ci}{$\bm{\lambda_i}$}{0.6}
%\kInDown[-0.2cm]{pid}{cd}{$\bm{\lambda_d}$}{0}
%
%
%\kLinkHVHLeft[2.7cm]{$\bm{{u}}$}{pid}{plt}{0}{0}
%\kLinkHV[$\bm{y}$]{plt}{obs}{0}{}
%\kLinkVH[$\bm{\hat{x}}$]{obs}{pid}{-0.2}{}
%\kLinkHVHRight[]{$\bm{{x}_m}$}{pidcm}{pid}{0}{0.2}
%
%\kLink[$\bm{\omega_n}$]{tscalc}{pidcm}
%\kLink[$\bm{x_{s},x_{pk}}$]{fis}{tscalc}
%\kLink[$\bm{b,c}$]{pid}{fis}
%
%\kMarkNodeAbove[-0.5cm]{}{tscalc}{mkwn}
%\kLinkHV[]{mkwn}{pid}{1}{}
%\kMarkNodeAbove[-0.5cm]{}{fis}{mkxts}
%\kLinkHV[]{mkxts}{pid}{0.85}{}
%
%\kInLeft[0cm]{pidcm}{rin}{$\bm{r}$}{-0.15}
%\kOutLeft[0cm]{pidcm}{umout}{$\bm{u_m}$}{0.15}
%
%\kInLeft[1cm]{tscalc}{tsl}{$\bm{ts,L}$}{-0.15}
%\kMarkNodeRight[-0.33cm]{}{tsl}{mktsl}
%\kLinkVH[]{mktsl}{pid}{0.15}{}
%
%\kMarkNodeLeft[0.5cm]{}{pid}{mku}
%\kLinkVH[]{mku}{pid}{-0.2}{}
%
%\kMarkNodeBelow[0cm]{}{obs}{mkxhat}
%\kLinkHV[]{mkxhat}{obs}{-0.5}{}
%
%\end{kblock}
%
%
%
%



\end{document}
